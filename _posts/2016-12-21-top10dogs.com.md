---
layout: post
title: top10dogs.com
---

The prime real estate on my LinkedIn page usually reserved for a job title is being used for the information that I am the owner and operator of top10dogs.com (not to be confused with toptendogs.com, I don't think they're gonna give that one up). It's really self-explanitory, you rate the dogs and hit submit to see your grade on how right you are based on the metric of how close you are to my ranking.  If you feel this is unfair, you are free to make your own dog ranking website. But for real that means is that I paid GoDaddy $15 for the domain and signed up for a AWS free account and somehow managed to get node up and running on a t2.micro.  I should have taken notes on my progress if not for a more comprehensive blog post on the start-to-finish process but at least for the gotcha reminders if I ever do it again.

At its core, the site is a bare minimum node+express job running on ubuntu.  ```express-generator``` did most of the work getting everything generated. I used [skeleton](getskeleton.com/) as my lightweight css framework, [pug](pugjs.org/) for templating (comes standard for node+express), and good ol' ```jQuery``` for the interactivity.  ```apache``` handles the go between for port 80 and node itself (*lesson learned #1: can't let node have port 80, that's unsafe.  Let apache do its thing with ProxyPass (side note, I recognize apache is probably overkill and nginx would do fine for this kind of thing but apache is automatically started as a service on AWS and it does everything I need it to.)*) 

The site only serves the one page with a API endpoint ```/try``` for jQuery to send POST requests to. The endpoint takes the list of dogs, compares it against my (perfect) list, and returns a correctness percentage message for the guesser.

I can't really call this a side gig, there's no monitization at all. No adsense, no affilate links, I just do it for the flippant title of "owner and operator". I want to call it a joke but usually those have a set-up and a punchline. The humor in "what if I had a dog ranking website" and then actually making one isn't going to win the hearts of millions.  It was a good freeform introduction to AWS, and that's a good a motivation as any to put a few hours in. 

AWS is a huge beast, powerful but not very approchable for casual web purposes.  I signed up for my free account (12 months! Generous!) and started my journey of "I just want an Ubuntu server that I can put code on  in the cloud".  Within a few minutes, I had an Elastic Beanstalk instance to call my own.  I didn't want an Elastic Beanstalk instance, nor did I (and still don't) know what it was.  Also, Elastic Beanstalk is a t1.micro instance? I think? But those are deprecated as far as my (limited) knowledge goes.  I know that I wanted a t2.micro, so I had to start over from square one.

I don't even know how I managed to get through security groups.  They may not even be doing anything, or maybe I did it right. All I know is that I made it through the setup and it works.

AWS has a feature called CodeDeploy, it's not for deploying code.  It's for deploying metadata? Like, the CI config data needed?  I've never done large scale anything, I've got a lot to learn, but until then I just ```scp```'d my files over to the t2.micro (*lesson learned #2: ```npm i ``` is so much faster than copying ```node_modules```*)

With everything on AWS, I was real proud seeing that everything was working when I ran the node.  I should have known, however, that keeping it alive after I closed the ssh connection would take more than just running it in the background.  ```nohup```, ```forever```, and ```pm2``` weren't playing nice with AWS either. I found [this stackoverflow answer](http://stackoverflow.com/questions/4018154/node-js-as-a-background-service) that explains that ```system.d``` is the "2015 answer".  My curiosity wanted to know what the "best practice" was without system.d (in case the scenario ever presents itself), but this was the key to keeping the server alive without me there.

This was my one "feel-good" project for 2016, and I'm happy with it as dumb as it is.  I should do something with more substance in 2017, I should have more time and drive now that more of my life has settled.